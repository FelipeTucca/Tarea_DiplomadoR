---
title: "Analisis exploratorio datos"
author: "Felipe Tucca"
date: '2022-05-03'
output: html_document
---

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)

library(readxl)
library(stats)
library(MASS)
library(Rlab)
library(ggplot2)
library(psych)
library(kableExtra)
library(knitr)
library(DT)
library(pander)
library(tidyverse)
library(dplyr)
library(tidyr)

```

## ***Análisis exploratorio de datos***

# **Análisis preliminar de datos**

Ajuste previo de la información presente en la planilla "mortalidad" donde se realizó transformación de datos mediante as.factor, colapso de columnas con la función gather creándose nuevas columnas "causa" - "muertos" y filtrar valores cero. Finalmente se realizó un resumen de una nueva planilla llamada "Mortalidad1" para el trabajo posterior solicitado en la Pauta de trabajo.

```{r resumen, echo=TRUE}
summary(Mortalidad)
```

# *Transformación de datos mediante as.factor*

```{r transformación datos, echo=TRUE}
Mortalidad$centro_id <- as.factor(Mortalidad$centro_id)
Mortalidad$año <- as.factor(Mortalidad$año)
Mortalidad$mes <- as.factor(Mortalidad$mes)
Mortalidad$Semana <- as.factor(Mortalidad$Semana)
```

```{r resumen con factores modificados, echo=TRUE}
summary(Mortalidad)
```

# *Ordenar datos con gather() y filtrar valores cero de la base de datos*

```{r ordenar datos con gather, echo=TRUE}
Mortalidad1 <- gather(Mortalidad,"Causa", "Muertos", 7:8 ) %>% filter(Muertos > 0)
```

```{r resumen, echo=TRUE}
summary(Mortalidad1)
```
```{r transformación datos, echo=TRUE}
Mortalidad1$Causa <- as.factor(Mortalidad1$Causa)
```

# *Resumen*

```{r resumen, echo=TRUE}
summary(Mortalidad1)
```


## **Variación de la variable de estudio mediante histogramas**

```{r histograma, echo=TRUE}
ggplot(Mortalidad1, aes(Muertos)) + 
  geom_histogram(bins = 30, color = "red", fill = "blue")+ 
  labs(title="Histograma", x="Muertos", y="Frecuencia") 
```

# *Transformación con función mutate ()*

```{r histograma dato transformado, echo=TRUE}
Mortalidad1 %>% mutate(Biomasa_ton= (Peso_g * Muertos)/1000000) %>% mutate(log_Muertos= log(Muertos)) %>% ggplot(aes(log_Muertos)) + 
  geom_histogram(bins = 20, color = "red", fill = "blue")+ labs(title="Histograma", x="Log Muertos", y="Frecuencia") 
```

```{r histograma dato transformado, echo=TRUE}
Mortalidad1 %>% mutate(Biomasa_ton= (Peso_g * Muertos)/1000000) %>% mutate(log_biomasa= log(Biomasa_ton)) %>% ggplot(aes(log_biomasa)) + 
  geom_histogram(bins = 20, color = "yellow", fill = "green")+ labs(title="Histograma", x="Log biomasa", y="Frecuencia")
```


```{r histograma, echo=TRUE}
ggplot(Mortalidad1, aes(Muertos))+geom_histogram(bins = 20, aes(color= Causa))+
  aes(position = "Muertos", bins =20, alpha = 0.3)
```

# **Tablas de frecuencia**

Para la base de datos se observa que la causa de mortalidad en salmon del Atlántico no esta balanceada, registrándose un mayor número de muertos por la variable oxígeno disuelto (864 muertos). En definitiva, existe mayor cantidad de observaciones por causa de muerte por OD que bloom de algas, lo que genera el desbalance de los datos.

```{r balance de datos, echo=TRUE}
table(Mortalidad1$Causa)
```


# *Gráficas*

# _Boxplot_

```{r boxplot, echo=TRUE}
Mortalidad1 %>% mutate(Biomasa_ton= (Peso_g * Muertos)/1000000) %>% mutate(log_Muertos= log(Muertos)) %>% ggplot(aes(x= año, y= log_Muertos, fill= Causa)) + geom_boxplot()
```


```{r interacción- de datos, echo=TRUE}
Mortalidad1 %>% ggplot(aes(x=Causa, y=Muertos, color=Causa))+
  geom_point(size=2) + labs(x= "Causa", y= "Número de muertos")+
  theme_gray()

```

